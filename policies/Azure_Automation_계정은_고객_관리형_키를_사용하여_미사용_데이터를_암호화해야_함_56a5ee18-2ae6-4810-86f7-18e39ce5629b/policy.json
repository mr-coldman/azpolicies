{
 "properties": {
  "displayName": "Azure Automation 계정은 고객 관리형 키를 사용하여 미사용 데이터를 암호화해야 함",
  "policyType": "BuiltIn",
  "mode": "Indexed",
  "description": "고객 관리형 키를 사용하여 Azure Automation 계정의 미사용 암호화를 관리합니다. 기본적으로 고객 데이터는 서비스 관리형 키로 암호화되지만 고객 관리형 키는 규정 준수 표준을 충족하기 위해 일반적으로 필요합니다. 고객 관리형 키를 사용하면 사용자가 만들고 소유한 Azure Key Vault 키로 데이터를 암호화할 수 있습니다. 사용자는 순환 및 관리를 비롯하여 키 수명 주기에 대한 모든 제어권과 책임이 있습니다. https://aka.ms/automation-cmk에서 자세히 알아보세요.",
  "metadata": {
   "version": "1.0.0",
   "category": "Automation"
  },
  "parameters": {
   "effect": {
    "type": "String",
    "metadata": {
     "displayName": "효과",
     "description": "'감사'는 비준수 리소스 생성이나 업데이트를 허용하지만 리소스에 비준수로 플래그 지정합니다. '거부'는 비준수 리소스 생성이나 업데이트를 차단합니다. '사용 안 함'은 정책을 끕니다."
    },
    "allowedValues": [
     "Audit",
     "Deny",
     "Disabled"
    ],
    "defaultValue": "Audit"
   }
  },
  "policyRule": {
   "if": {
    "allOf": [
     {
      "field": "type",
      "equals": "Microsoft.Automation/automationAccounts"
     },
     {
      "field": "Microsoft.Automation/automationAccounts/encryption.keySource",
      "notEquals": "Microsoft.Keyvault"
     }
    ]
   },
   "then": {
    "effect": "[parameters('effect')]"
   }
  }
 },
 "id": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
 "type": "Microsoft.Authorization/policyDefinitions",
 "name": "56a5ee18-2ae6-4810-86f7-18e39ce5629b"
}